# JSON 转像素艺术动画生成器

**版本：** 1.0
**日期：** 2025年07月27日

## 1. 引言与愿景

AI 像素艺术动画生成器是一款桌面实用工具，旨在填补结构化数据与可视化像素艺术之间的鸿沟。其核心目标是为艺术家、游戏开发者和创意编码者提供一个无缝的工具，以即时可视化和导出通过简单 JSON 格式定义的像素艺术和动画。我们的愿景是创建一个轻量级、直观且功能强大的动画生成器，以加速像素艺术的工作流程，特别是对于程序化生成或数据驱动的图形。

## 2. 项目目标与目的

*   **主要目标：** 创建一个用户友好的图形界面，用于从指定的 JSON 结构中渲染静态和动画像素艺术。
*   **关键目标 1：** 在应用程序内直接实现像素艺术和动画的实时预览。
*   **关键目标 2：** 支持两种核心导出格式：用于静态图像的高质量PNG，以及用于动画的游戏开发就绪的PNG雪碧图。
*   **用户目标：** 允许用户快速迭代其 JSON 数据，并实时查看视觉结果，从而极大地加快创作过程。

## 3. 目标受众

*   **游戏开发者：** 需要将程序化生成或易于编辑的像素艺术整合到其游戏中的专业人士和业余爱好者。
*   **像素艺术家：** 寻求一种工具来从基础数据结构自动化创建动画或其艺术作品变体的艺术家。
*   **创意编码者与业余爱好者：** 探索代码与艺术交集的个人，他们可以使用此工具将数据驱动的视觉创意变为现实。

## 4. 功能与功能性需求

### 4.1. 核心功能

*   **JSON 数据输入：** 应用程序设有一个专用的文本区域，供用户粘贴其 JSON 数据。
*   **从文件加载：** 用户可以通过文件对话框直接加载一个本地的JSON文件，其内容将自动填充到JSON数据输入区。
*   **实时渲染引擎：** 一个强大的渲染引擎（`renderer.py`），用于解析 JSON 并生成图像数据。
*   **多格式导出：** 能够根据 JSON 结构将渲染的艺术作品保存为不同格式。

### 4.2. 图形用户界面（GUI）

*   **主窗口：** 一个名为“AI 像素艺术动画生成器”的单一、直观的窗口。
*   **可调整大小的窗格：** UI 分为两个主要部分（JSON 输入和预览），由一个可拖动的分隔条隔开，以实现灵活的布局调整。
*   **交互式预览面板 (Interactive Preview Panel)：** 一个专门用于显示渲染图像或动画的区域，现在具备了基础的像素编辑功能：
    *   **直接编辑：** 用户可以直接在预览图上进行点击操作。
    *   **绘制与擦除：** 左键单击可以在画布上使用当前选定的颜色绘制像素；右键单击可将像素恢复为背景色（橡皮擦功能）。
    *   **调色板集成：** 面板旁边会展示当前JSON数据中定义的调色板，用户可以点选颜色以用于绘制。
    *   **数据双向同步：** 在预览画布上的任何修改，都会被实时地反向更新到左侧的JSON数据输入区中，反之亦然。这确保了视觉表现与源数据的绝对一致。
    *   **动画编辑工作流：** 对于动画，面板下方将提供一套完整的控制工具，以实现对特定帧的精确编辑：
        *   **播放/暂停控制：** 允许用户随时暂停动画，将画面定格在某一帧进行观察和操作。
        *   **逐帧导航：** 提供“上一帧”/“下一帧”按钮及一个帧滑块，让用户可以精确地跳转到任意指定帧。
        *   **编辑模式：** 动画一旦暂停，即自动进入“编辑模式”，此时的绘制和擦除操作将仅作用于当前显示的帧。
        *   **帧数据同步：** 对特定帧的修改将准确地更新到JSON数据中`frames`数组对应的帧数据上。
*   **控制面板：** 一个包含所有交互式控件的部分：
    *   **加载JSON按钮：** 打开一个文件选择对话框，允许用户选择一个 `.json` 文件。选定的文件内容将被加载到JSON输入文本框中。
    *   **渲染/播放动画按钮：** 触发在预览面板中渲染 JSON 数据。如果数据包含多个帧，则启动播放。
    *   **另存为...按钮：** 打开文件对话框以保存艺术作品。
    *   **透明背景复选框：** 允许用户为输出文件选择透明或默认的纯色背景。
    *   **持续时间（毫秒）输入框：** 一个用于指定动画中每帧持续时间的字段，单位为毫秒。

### 4.3. 支持的导出格式

*   **PNG（静态图）：** 用于包含 `pixels` 字段的JSON数据，生成单张PNG图片。
*   **PNG 雪碧图（动画）：** 用于包含 `frames` 字段的JSON数据，此选项将所有动画帧水平拼接成一个PNG文件，非常适合游戏引擎。
*   **JSON 数据备份：** 保存图像时，应用程序会自动保存源JSON数据的副本。图片文件存储在 `output` 目录下，而对应的JSON文件则以相同的文件名保存在 `assets` 目录下（例如，`output/my_animation.png` 和 `assets/my_animation.json`）。

## 5. 技术规格

### 5.1. JSON 数据模式

应用程序需要特定的 JSON 结构：

```json
{
  "canvas_size": [16, 16], 
  "palette": {
    "0": "#000000",
    "1": "#FFFFFF",
    "2": "#C62828"
  },
  // 对于单张图片
  "pixels": [
    [0, 1, 2, ...],
    [...]
  ],
  // 对于动画
  "frames": [
    [...], // 帧 1
    [...], // 帧 2
  ],
  "duration_ms": 100 // 可选
}
```

*   `canvas_size`：一个 `[宽度, 高度]` 数组。
*   `palette`：一个将整数字符串键映射到十六进制颜色代码的字典。
*   `pixels`：一个表示单张图片的二维数组。
*   `frames`：一个二维数组的数组，其中每个二维数组是动画的一帧。
*   `duration_ms`：（可选）用于控制应用内预览动画的播放速度，单位为毫秒。

### 5.2. 技术栈

*   **语言：** Python 3
*   **GUI 框架：** Tkinter
*   **图像处理：** Pillow (PIL)
*   **核心模块：**
    *   `app.py`：管理 GUI、用户交互和事件处理。
    *   `renderer.py`：处理所有数据解析、图像创建和文件保存逻辑。

## 6. 未来考虑（v1.0 范围之外）

*   **错误高亮：** 在 JSON 输入区域进行语法高亮，并进行实时错误检查。
*   **高级导出选项：** 对雪碧图布局进行更多控制（例如，网格排列、间距）。
*   **调色板选择器：** 一个在应用内创建和编辑调色板的可视化工具。
*   **撤销/重做：** 支持在 JSON 文本区域撤销更改。